<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Megatrans-4 System</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link th:href="@{/css/table.css}" rel="stylesheet" media="screen" />
    <link th:href="@{/css/button.css}" rel="stylesheet" media="screen" />
    <link th:href="@{/css/Interface.css}" rel="stylesheet" media="screen" />
</head>

<body>

<div id="container">

    <div id="header">
        <h2>Отчеты</h2>
    </div>

    <div id="sidebar">

        <form action="#" th:action="@{/ControllerReport/reportSystem}" th:object="${exchangeServiceObjectView}"   method="post">
            SaveEx: <input type="text" size="20" th:field="*{dateTime}" />
            <input type="submit" value="Report" />
        </form>


        <form action="#" th:action="@{/ControllerReport/analizNodeHashReport}" th:object="${exchangeServiceObjectView}"  method="post">
            System: <input type="text" size="20" th:field="*{hash}" />
            <input type="submit" value="Report" />
        </form>

        <form action="#" th:action="@{/ControllerReport/analizNodeData}" th:object="${exchangeServiceObjectView}"   method="post">
            NodeIp: <input type="text" size="20" th:field="*{ipAddress}"/>
            <input type="submit" value="Report" />
        </form>

        <form action="#" th:action="@{/ControllerDelete/deleteHash}" th:object="${exchangeServiceObjectView}"   method="post">
            Hash:<input type="text" size="20" th:field="*{hash}"/>
            <input type="submit" value="Delete" />
        </form>

    </div>



            <table border="1" cellpadding="4" cellspacing="0" width="100%" id="stq" class='pq-grid-summary' >
                <caption>System №5</caption>

                <tr>
                    <th width="3%">Id</th>

                    <th width="6%">Date</th>

                    <th width="6%">IpNode</th>

                    <th colspan="2">
                        errored
                        Blocks</th>

                    <th colspan="2">
                        errored
                        Seconds</th>

                    <th colspan="2">
                        severely
                        Errored
                        Seconds</th>

                    <th colspan="2">
                        background
                        Block
                        Errors</th>

                    <th colspan="2">esr[%]</th>


                    <th colspan="2">sers[%]</th>


                    <th colspan="2">bber[%]</th>


                    <th colspan="2">available
                        Time</th>

                    <th colspan="2">unavailable
                        Time</th>

                    <th colspan="2">nmr dB</th>

                </tr>



                <tr th:block th:each="map:${maps}">

                    <td th:utext="${map.getKey()}">Id</td>
                    <td th:utext="${map.getValue().localDateTime}"></td>
                    <td th:utext="${map.getValue().ipNode}"></td>


                    <td th:utext="${map.getValue().erroredBlocksValueSide1}"></td>
                    <td th:utext="${map.getValue().erroredBlocksValueSide2}"></td>


                    <td th:utext="${map.getValue().erroredSecondValueSide1}"></td>
                    <td th:utext="${map.getValue().erroredSecondValueSide2}"></td>


                    <td th:utext="${map.getValue().severelyErroredSecondsValueSide1}"></td>
                    <td th:utext="${map.getValue().severelyErroredSecondsValueSide2}"></td>


                    <td th:utext="${map.getValue().backgroundBlockErrorsValueSide1}"></td>
                    <td th:utext="${map.getValue().backgroundBlockErrorsValueSide2}"></td>

                    <td th:utext="${map.getValue().esrValueSide1}"></td>
                    <td th:utext="${map.getValue().esrValueSide2}"></td>


                    <td th:utext="${map.getValue().sesrValueSide1}"></td>
                    <td th:utext="${map.getValue().sesrValueSide2}"></td>



                    <td th:utext="${map.getValue().bberValueSide1}"></td>
                    <td th:utext="${map.getValue().bberValueSide2}"></td>


                    <td th:utext="${map.getValue().availableTimeValueSide1}"></td>
                    <td th:utext="${map.getValue().availableTimeValueSide2}"></td>



                    <td th:utext="${map.getValue().unavailableTimeValueSide1}"></td>
                    <td th:utext="${map.getValue().unavailableTimeValueSide2}"></td>


                    <td th:utext="${map.getValue().nmrValueSide1}"></td>
                    <td th:utext="${map.getValue().nmrValueSide2}"></td>


                </tr>

            </table>

</div>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<script>
        buttonex=document.getElementById('ReportEX');
        buttonex.addEventListener('click', function ()
        {
            let blob = new Blob( [ $stq.innerhtml()], { type: "text/html"} );

            window.navigator.msSaveOrOpenBlob( blob, "output.xls" );
        });



</script>

</body>
</html>